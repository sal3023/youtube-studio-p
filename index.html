<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø§Ø³ØªØ¯ÙŠÙˆ Ø§Ù„Ø°ÙƒÙŠ AI</title>
    <style>
        :root { --yt: #FF0000; --ai: #8e44ad; --dark: #121212; --panel: #1e1e1e; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: var(--dark); color: white; margin: 0; padding: 20px; text-align: center; }
        .container { background: var(--panel); max-width: 600px; margin: auto; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.6); border: 1px solid #333; }
        
        h2 { margin-bottom: 20px; font-weight: 300; }
        
        input, select, textarea { 
            width: 100%; margin: 8px 0 15px 0; padding: 12px; 
            border-radius: 8px; border: 1px solid #444; 
            background: #121212; color: white; font-size: 16px; outline: none; box-sizing: border-box;
        }
        input:focus { border-color: var(--yt); }
        
        .btn { border: none; padding: 12px; width: 100%; border-radius: 8px; font-size: 16px; font-weight: bold; cursor: pointer; transition: 0.3s; margin-top: 10px; color: white; }
        .btn-yt { background: var(--yt); }
        .btn-ai { background: linear-gradient(45deg, #8e44ad, #3498db); box-shadow: 0 4px 15px rgba(142, 68, 173, 0.4); margin-bottom: 20px; }
        .btn-ai:hover { transform: scale(1.02); }
        
        .file-box { border: 2px dashed #444; padding: 20px; border-radius: 8px; cursor: pointer; margin-bottom: 10px; color: #aaa; }
        .file-box:hover { border-color: var(--yt); background: #252525; color: white; }
        
        .hidden { display: none; }
        .success-box { background: #1a2e1d; padding: 15px; border-radius: 10px; margin-top: 20px; border: 1px solid #2ba640; display: none; }
        
        .share-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-top: 10px; }
        .share-btn { padding: 8px; font-size: 12px; background: #333; border-radius: 5px; color: white; text-decoration: none; display: block; cursor: pointer; border: none; }
        .share-btn:hover { background: #444; }
    </style>
</head>
<body>

<div class="container">
    <h2>ğŸ¤– Ø§Ù„Ø§Ø³ØªØ¯ÙŠÙˆ Ø§Ù„Ø°ÙƒÙŠ <span style="color:var(--ai)">AI</span></h2>

    <div id="auth-section">
        <p style="color:#888;">Ø£Ø¯Ø®Ù„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ Ù…Ø±Ø© ÙˆØ§Ø­Ø¯Ø© ÙÙ‚Ø·</p>
        <input type="text" id="client-id-input" placeholder="Google Client ID (Ù„Ù„ÙŠÙˆØªÙŠÙˆØ¨)">
        <input type="password" id="ai-key-input" placeholder="Gemini API Key (Ù„Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ)">
        <button class="btn btn-yt" onclick="authenticate()">ğŸ”— Ø­ÙØ¸ ÙˆØ¯Ø®ÙˆÙ„</button>
        <p style="font-size:11px; color:#555; margin-top:10px;">Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù…ÙØ§ØªÙŠØ­ ÙÙŠ Ø¬Ù‡Ø§Ø²Ùƒ ÙÙ‚Ø· Ø¨Ø£Ù…Ø§Ù†.</p>
        <p style="font-size:11px; color:#555;">Ø§Ø­ØµÙ„ Ø¹Ù„Ù‰ Ù…ÙØªØ§Ø­ Ø§Ù„Ø°ÙƒØ§Ø¡ Ù…Ù†: <a href="https://aistudio.google.com/app/apikey" target="_blank" style="color:#8e44ad;">Google AI Studio</a></p>
    </div>

    <div id="dashboard" class="hidden">
        
        <div style="background:#2c2c2c; padding:15px; border-radius:10px; margin-bottom:20px; border:1px solid #444;">
            <h3 style="margin:0 0 10px 0; color: #d1a3ff;">âœ¨ Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h3>
            <input type="text" id="topic-input" placeholder="Ø¹Ù† Ù…Ø§Ø°Ø§ ÙŠØªØ­Ø¯Ø« Ø§Ù„ÙÙŠØ¯ÙŠÙˆØŸ (Ù…Ø«Ù„Ø§Ù‹: ÙÙ„ÙˆÙ‚ Ø³ÙØ±)">
            <button class="btn btn-ai" onclick="generateAI()">âš¡ Ø§ÙƒØªØ¨ Ù„ÙŠ Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ§Ù„ÙˆØµÙ ÙˆØ§Ù„ØªØ§Ø¬Ø²</button>
        </div>

        <hr style="border-color:#333; margin:20px 0;">

        <div class="file-box" onclick="document.getElementById('video-file').click()">
            ğŸ“‚ Ø§Ø®ØªØ± Ù…Ù„Ù Ø§Ù„ÙÙŠØ¯ÙŠÙˆ
        </div>
        <input type="file" id="video-file" accept="video/*" style="display:none" onchange="updateUI('video')">
        <div id="video-name" style="font-size:12px; color:#3ea6ff; text-align:right;"></div>

        <div class="file-box" style="padding:10px;" onclick="document.getElementById('thumb-file').click()">
            ğŸ–¼ï¸ Ø§Ø®ØªØ± ØµÙˆØ±Ø© Ù…ØµØºØ±Ø©
        </div>
        <input type="file" id="thumb-file" accept="image/*" style="display:none" onchange="updateUI('thumb')">
        <div id="thumb-name" style="font-size:12px; color:#3ea6ff; text-align:right;"></div>

        <input type="text" id="video-title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ÙÙŠØ¯ÙŠÙˆ">
        <textarea id="video-desc" rows="4" placeholder="ÙˆØµÙ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ"></textarea>
        <input type="text" id="video-tags" placeholder="Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù…ÙØªØ§Ø­ÙŠØ© (Tags)">
        
        <select id="video-privacy">
            <option value="public">ğŸŒ Ø¹Ù„Ù†ÙŠ</option>
            <option value="unlisted">ğŸ”— ØºÙŠØ± Ù…Ø¯Ø±Ø¬</option>
            <option value="private">ğŸ”’ Ø®Ø§Øµ</option>
        </select>

        <button id="upload-btn" class="btn btn-yt" onclick="startUpload()">ğŸš€ Ø±ÙØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ</button>
        <p id="status-text" style="color:#aaa; font-size:14px; margin-top:10px;"></p>

        <div id="share-panel" class="success-box">
            <h3 style="margin:0; color:#4caf50;">âœ… ØªÙ… Ø§Ù„Ù†Ø´Ø±!</h3>
            <div class="share-grid">
                <a id="share-fb" target="_blank" class="share-btn">Facebook</a>
                <a id="share-x" target="_blank" class="share-btn">Platform X</a>
                <a id="share-wa" target="_blank" class="share-btn">WhatsApp</a>
            </div>
            <textarea id="blogger-code" rows="2" style="margin-top:10px; font-size:10px; background:black; color:#0f0; width:100%; box-sizing:border-box;"></textarea>
            <button onclick="copyBlogger()" class="share-btn" style="width:100%; margin-top:5px;">ğŸ“‹ Ù†Ø³Ø® ÙƒÙˆØ¯ Ø¨Ù„ÙˆØ¬Ø±</button>
        </div>
    </div>
</div>

<script>
    let accessToken = "";

    window.onload = function() {
        if(localStorage.getItem("yt_client_id")) document.getElementById("client-id-input").value = localStorage.getItem("yt_client_id");
        if(localStorage.getItem("ai_key")) document.getElementById("ai-key-input").value = localStorage.getItem("ai_key");
        
        const params = new URLSearchParams(window.location.hash.substring(1));
        if (params.has("access_token")) {
            accessToken = params.get("access_token");
            document.getElementById("auth-section").classList.add("hidden");
            document.getElementById("dashboard").classList.remove("hidden");
        }
    };

    function authenticate() {
        const clientId = document.getElementById("client-id-input").value.trim();
        const aiKey = document.getElementById("ai-key-input").value.trim();
        
        if (!clientId || !aiKey) return alert("Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…ÙØ§ØªÙŠØ­!");
        
        localStorage.setItem("yt_client_id", clientId);
        localStorage.setItem("ai_key", aiKey);
        
        const redirect = window.location.href.split('?')[0].replace(/\/$/, "");
        window.location.href = `https://accounts.google.com/o/oauth2/v2/auth?client_id=${clientId}&redirect_uri=${redirect}&response_type=token&scope=https://www.googleapis.com/auth/youtube.upload&include_granted_scopes=true&state=pass`;
    }

    // ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ
    async function generateAI() {
        const topic = document.getElementById("topic-input").value;
        const apiKey = localStorage.getItem("ai_key");
        
        if(!topic) return alert("Ø§ÙƒØªØ¨ Ù…ÙˆØ¶ÙˆØ¹ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø£ÙˆÙ„Ø§Ù‹!");

        const btn = document.querySelector(".btn-ai");
        const originalText = btn.innerText;
        btn.innerText = "ğŸ¤– Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙÙƒÙŠØ±...";
        btn.disabled = true;

        const prompt = `Ø£Ù†Øª Ø®Ø¨ÙŠØ± ÙŠÙˆØªÙŠÙˆØ¨ Ù…Ø­ØªØ±Ù. Ù„Ø¯ÙŠ ÙÙŠØ¯ÙŠÙˆ Ø¹Ù†: "${topic}". 
        1. Ø§ÙƒØªØ¨ Ù„ÙŠ Ø¹Ù†ÙˆØ§Ù†Ø§Ù‹ Ø¬Ø°Ø§Ø¨Ø§Ù‹ Ø¬Ø¯Ø§Ù‹ (Clickbait) Ø¨Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©.
        2. Ø§ÙƒØªØ¨ ÙˆØµÙØ§Ù‹ Ø·ÙˆÙŠÙ„Ø§Ù‹ Ù„Ù„ÙÙŠØ¯ÙŠÙˆ Ù…Ø¹ Ù‡Ø§Ø´ØªØ§Ø¬Ø§Øª.
        3. Ø§ÙƒØªØ¨ ÙƒÙ„Ù…Ø§Øª Ù…ÙØªØ§Ø­ÙŠØ© (Tags) Ù…ÙØµÙˆÙ„Ø© Ø¨ÙÙˆØ§ØµÙ„.
        Ø§ÙØµÙ„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… Ø¨Ù€ "|||"`;

        try {
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${apiKey}`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            const data = await response.json();
            if(data.error) throw new Error(data.error.message);
            
            const text = data.candidates[0].content.parts[0].text;
            const sections = text.split("|||");
            
            if(sections.length > 0) document.getElementById("video-title").value = sections[0].replace(/\*| Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:|Ø¹Ù†ÙˆØ§Ù†:/g, "").trim();
            if(sections.length > 1) document.getElementById("video-desc").value = sections[1].replace(/\*| Ø§Ù„ÙˆØµÙ:|ÙˆØµÙ:/g, "").trim();
            if(sections.length > 2) document.getElementById("video-tags").value = sections[2].replace(/\*| ÙƒÙ„Ù…Ø§Øª:|Ø§Ù„ÙƒÙ„Ù…Ø§Øª:/g, "").trim();

            btn.innerText = "âœ… ØªÙ… Ø§Ù„ØªÙˆÙ„ÙŠØ¯ Ø¨Ù†Ø¬Ø§Ø­!";
            setTimeout(() => { btn.innerText = originalText; btn.disabled = false; }, 3000);

        } catch (error) {
            alert("Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ: " + error);
            btn.innerText = "âŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰";
            btn.disabled = false;
        }
    }

    function updateUI(type) {
        const file = document.getElementById(type + "-file").files[0];
        if(file) document.getElementById(type + "-name").innerText = "âœ… " + file.name;
    }

    async function startUpload() {
        const file = document.getElementById("video-file").files[0];
        const title = document.getElementById("video-title").value;
        const desc = document.getElementById("video-desc").value;
        const tags = document.getElementById("video-tags").value.split(",");
        const privacy = document.getElementById("video-privacy").value;

        if (!file || !title) return alert("Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù†Ø§Ù‚ØµØ©!");

        document.getElementById("upload-btn").disabled = true;
        document.getElementById("status-text").innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø±ÙØ¹...";

        try {
            const metadata = { snippet: { title, description: desc, tags: tags }, status: { privacyStatus: privacy } };
            const videoId = await uploadFile(file, metadata);
            
            const thumb = document.getElementById("thumb-file").files[0];
            if(thumb) {
                 document.getElementById("status-text").innerText = "â³ Ø¬Ø§Ø±ÙŠ Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…ØµØºØ±Ø©...";
                 await uploadThumb(videoId, thumb);
            }

            setupSharePanel(videoId, title, desc);

        } catch (err) {
            document.getElementById("status-text").innerText = "âŒ Ø®Ø·Ø£: " + err.message;
            document.getElementById("upload-btn").disabled = false;
        }
    }

    function uploadFile(file, metadata) {
        return new Promise((resolve, reject) => {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "https://www.googleapis.com/upload/youtube/v3/videos?uploadType=resumable&part=snippet,status", true);
            xhr.setRequestHeader("Authorization", "Bearer " + accessToken);
            xhr.setRequestHeader("Content-Type", "application/json");
            xhr.onload = () => {
                if (xhr.status === 200) {
                    const uploadUrl = xhr.getResponseHeader("Location");
                    const uploader = new XMLHttpRequest();
                    uploader.open("PUT", uploadUrl, true);
                    uploader.onload = () => {
                        if (uploader.status === 200 || uploader.status === 201) resolve(JSON.parse(uploader.responseText).id);
                        else reject(new Error("ÙØ´Ù„ Ø§Ù„Ø±ÙØ¹"));
                    };
                    uploader.send(file);
                } else reject(new Error("ÙØ´Ù„ Ø§Ù„ØªÙ‡ÙŠØ¦Ø©"));
            };
            xhr.send(JSON.stringify(metadata));
        });
    }

    function uploadThumb(videoId, file) {
        return fetch(`https://www.googleapis.com/upload/youtube/v3/thumbnails/set?videoId=${videoId}`, {
            method: 'POST', headers: { 'Authorization': 'Bearer ' + accessToken }, body: file
        });
    }

    function setupSharePanel(videoId, title, desc) {
        document.getElementById("status-text").innerText = "âœ… ØªÙ… Ø§Ù„Ø±ÙØ¹ Ø¨Ù†Ø¬Ø§Ø­!";
        document.getElementById("share-panel").style.display = "block";
        const url = `https://youtu.be/${videoId}`;
        const encodedUrl = encodeURIComponent(url);
        const encodedTitle = encodeURIComponent(title);
        
        document.getElementById("share-fb").href = `https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}`;
        document.getElementById("share-x").href = `https://twitter.com/intent/tweet?url=${encodedUrl}&text=${encodedTitle}`;
        document.getElementById("share-wa").href = `https://api.whatsapp.com/send?text=${encodedTitle} ${encodedUrl}`;
        
        document.getElementById("blogger-code").value = `<div style="text-align:center;"><iframe width="100%" height="400" src="https://www.youtube.com/embed/${videoId}" frameborder="0" allowfullscreen></iframe></div><h3>${title}</h3><p>${desc}</p>`;
    }

    function copyBlogger() {
        const copyText = document.getElementById("blogger-code");
        copyText.select();
        document.execCommand("copy");
        alert("ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯!");
    }
</script>

</body>
</html>
