#!/bin/bash
# Ø³ÙƒØ±Ø¨Øª Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ Ø§Ù„ÙƒØ§Ù…Ù„
# Ù‚Ù… Ø¨ØªØ´ØºÙŠÙ„: chmod +x setup.sh && ./setup.sh

mkdir -p ai-enterprise-system/{backend/src/{auth,routes,middleware},frontend/{src/{components,services},public},prometheus,grafana/{dashboards,provisioning/datasources},logs}
cd ai-enterprise-system

# 1. Docker Compose Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ
cat > docker-compose.yml << 'EOF'
version: '3.8'

services:
  postgres:
    image: postgres:15-alpine
    environment:
      POSTGRES_USER: admin
      POSTGRES_PASSWORD: ${DB_PASSWORD:-EnterpriseAI@2024}
      POSTGRES_DB: enterprise_ai
    volumes:
      - postgres_data:/var/lib/postgresql/data
    networks:
      - backend-net
    restart: unless-stopped

  api:
    build: ./backend
    environment:
      - NODE_ENV=production
      - PORT=3000
      - JWT_SECRET=${JWT_SECRET:-SuperSecretKey-ChangeThis-InProduction-32Chars}
      - AD_URL=${AD_URL:-ldap://localhost:389}
      - AD_BASE_DN=${AD_BASE_DN:-dc=company,dc=local}
      - AD_DOMAIN=${AD_DOMAIN:-company.local}
      - AD_SERVICE_USER=${AD_SERVICE_USER:-svc-ai@company.local}
      - AD_SERVICE_PASSWORD=${AD_SERVICE_PASSWORD}
      - OLLAMA_MODEL=llama3:8b
      - OLLAMA_URL=http://ollama:11434
    volumes:
      - ./logs:/logs
    networks:
      - backend-net
      - ai-net
    depends_on:
      - postgres
      - ollama
    restart: unless-stopped

  ollama:
    image: ollama/ollama:latest
    volumes:
      - ollama_data:/root/.ollama
    networks:
      - ai-net
    restart: unless-stopped
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 8G

  frontend:
    build: ./frontend
    ports:
      - "80:80"
    networks:
      - backend-net
    depends_on:
      - api
    restart: unless-stopped

  prometheus:
    image: prom/prometheus:latest
    volumes:
      - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml
      - prometheus_data:/prometheus
    command:
      - '--config.file=/etc/prometheus/prometheus.yml'
      - '--storage.tsdb.path=/prometheus'
      - '--web.console.libraries=/usr/share/prometheus/console_libraries'
      - '--web.console.templates=/usr/share/prometheus/consoles'
    networks:
      - backend-net
    restart: unless-stopped

  grafana:
    image: grafana/grafana:latest
    ports:
      - "3000:3000"
    environment:
      - GF_SECURITY_ADMIN_USER=admin
      - GF_SECURITY_ADMIN_PASSWORD=${GRAFANA_PASSWORD:-admin123}
      - GF_USERS_ALLOW_SIGN_UP=false
      - GF_SERVER_ROOT_URL=http://localhost:3000
    volumes:
      - grafana_data:/var/lib/grafana
      - ./grafana/provisioning:/etc/grafana/provisioning
    networks:
      - backend-net
    depends_on:
      - prometheus
    restart: unless-stopped

networks:
  backend-net:
    driver: bridge
  ai-net:
    driver: bridge
    internal: true

volumes:
  postgres_data:
  ollama_data:
  prometheus_data:
  grafana_data:
EOF

# 2. Backend Package.json
cat > backend/package.json << 'EOF'
{
  "name": "ai-enterprise-api",
  "version": "1.0.0",
  "description": "Enterprise AI System with AD Integration",
  "main": "src/server.js",
  "scripts": {
    "start": "node src/server.js"
  },
  "dependencies": {
    "express": "^4.18.2",
    "cors": "^2.8.5",
    "helmet": "^7.1.0",
    "activedirectory2": "^2.1.0",
    "jsonwebtoken": "^9.0.2",
    "axios": "^1.6.0",
    "express-rate-limit": "^7.1.0",
    "prom-client": "^15.0.0",
    "winston": "^3.11.0"
  }
}
EOF

# 3. Backend Dockerfile
cat > backend/Dockerfile << 'EOF'
FROM node:18-alpine
WORKDIR /app
COPY package*.json ./
RUN npm ci --only=production
COPY src/ ./src/
EXPOSE 3000
CMD ["node", "src/server.js"]
EOF

# 4. Ø§Ù„Ø®Ø§Ø¯Ù… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ (Ù…ÙˆØ­Ø¯)
cat > backend/src/server.js << 'EOF'
const express = require('express');
const cors = require('cors');
const helmet = require('helmet');
const rateLimit = require('express-rate-limit');
const client = require('prom-client');
const winston = require('winston');
const jwt = require('jsonwebtoken');
const axios = require('axios');

// Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
const logger = winston.createLogger({
  level: 'info',
  format: winston.format.json(),
  transports: [
    new winston.transports.Console(),
    new winston.transports.File({ filename: '/logs/audit.log' })
  ]
});

const app = express();
const register = new client.Registry();
client.collectDefaultMetrics({ register });

// Metrics
const aiRequestsCounter = new client.Counter({
  name: 'ai_requests_total',
  help: 'Total AI requests',
  labelNames: ['department', 'status']
});
register.registerMetric(aiRequestsCounter);

// Middleware Ø£Ù…Ù†ÙŠ
app.use(helmet());
app.use(cors({ origin: true, credentials: true }));
app.use(express.json());

// Rate Limiting
const limiter = rateLimit({
  windowMs: 15 * 60 * 1000,
  max: 100,
  message: { error: 'ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„Ù…Ø³Ù…ÙˆØ­ Ù…Ù† Ø§Ù„Ø·Ù„Ø¨Ø§Øª' }
});
app.use(limiter);

// Auth Middleware
const authenticateToken = (req, res, next) => {
  const authHeader = req.headers['authorization'];
  const token = authHeader && authHeader.split(' ')[1];
  
  if (!token) return res.status(401).json({ error: 'Ù…Ø·Ù„ÙˆØ¨ ØªÙˆÙƒÙ† Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©' });
  
  jwt.verify(token, process.env.JWT_SECRET || 'default-secret', (err, user) => {
    if (err) return res.status(403).json({ error: 'ØªÙˆÙƒÙ† ØºÙŠØ± ØµØ§Ù„Ø­' });
    req.user = user;
    next();
  });
};

// Routes

// ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ (Ù…Ø­Ø§ÙƒØ§Ø© AD Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
app.post('/api/auth/login', async (req, res) => {
  try {
    const { username, password } = req.body;
    
    // ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬: Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Active Directory Ù‡Ù†Ø§
    // Ù„Ù„ØªØ¬Ø±Ø¨Ø©: Ù‚Ø¨ÙˆÙ„ Ø£ÙŠ user/pass ÙŠØ¨Ø¯Ø£ Ø¨Ù€ company\
    if (!username.includes('\\') && !username.includes('@')) {
      return res.status(401).json({ error: 'ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… domain\\username Ø£Ùˆ Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ' });
    }

    const user = {
      username: username.split('\\')[1] || username.split('@')[0],
      department: username.includes('hr') ? 'HR' : username.includes('finance') ? 'Finance' : 'IT',
      role: username.includes('admin') ? 'admin' : 'user'
    };

    const token = jwt.sign(user, process.env.JWT_SECRET || 'default-secret', { expiresIn: '8h' });
    
    logger.info({ type: 'LOGIN', user: user.username, timestamp: new Date() });
    
    res.json({ token, user });
  } catch (error) {
    res.status(500).json({ error: error.message });
  }
});

// AI Chat
app.post('/api/ai/chat', authenticateToken, async (req, res) => {
  try {
    const { message, context = 'general' } = req.body;
    const { department, username } = req.user;

    // Audit
    logger.info({
      type: 'AI_QUERY',
      user: username,
      department,
      question: message.substring(0, 100),
      timestamp: new Date()
    });

    // Context Check
    if (context === 'hr' && department !== 'HR') {
      return res.status(403).json({ error: 'ØºÙŠØ± Ù…ØµØ±Ø­ Ø¨Ø§Ù„ÙˆØµÙˆÙ„ Ù„Ø³ÙŠØ§Ù‚ Ø§Ù„Ù…ÙˆØ§Ø±Ø¯ Ø§Ù„Ø¨Ø´Ø±ÙŠØ©' });
    }

    // Ollama Request
    const response = await axios.post(`${process.env.OLLAMA_URL || 'http://localhost:11434'}/api/generate`, {
      model: process.env.OLLAMA_MODEL || 'llama3:8b',
      prompt: `Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ Ø°ÙƒÙŠ Ù„Ù„Ø´Ø±ÙƒØ©. Ø§Ù„Ø³ÙŠØ§Ù‚: ${context}. Ø§Ù„Ø³Ø¤Ø§Ù„: ${message}`,
      stream: false,
      options: { temperature: 0.7, num_predict: 500 }
    });

    aiRequestsCounter.inc({ department, status: 'success' });
    
    res.json({
      response: response.data.response,
      model: response.data.model,
      user: username
    });

  } catch (error) {
    aiRequestsCounter.inc({ department: req.user?.department || 'unknown', status: 'error' });
    console.error('AI Error:', error.message);
    res.status(500).json({ error: 'Ø®Ø·Ø£ ÙÙŠ Ø®Ø¯Ù…Ø© AI' });
  }
});

// Metrics
app.get('/metrics', async (req, res) => {
  res.set('Content-Type', register.contentType);
  res.end(await register.metrics());
});

// Health
app.get('/health', (req, res) => {
  res.json({ status: 'UP', timestamp: new Date() });
});

const PORT = process.env.PORT || 3000;
app.listen(PORT, '0.0.0.0', () => {
  console.log(`ğŸš€ Enterprise AI API running on port ${PORT}`);
});
EOF

# 5. Frontend Package.json
cat > frontend/package.json << 'EOF'
{
  "name": "ai-enterprise-frontend",
  "version": "1.0.0",
  "private": true,
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0",
    "react-scripts": "5.0.1",
    "axios": "^1.6.0",
    "react-markdown": "^9.0.0"
  },
  "scripts": {
    "start": "react-scripts start",
    "build": "react-scripts build"
  },
  "eslintConfig": {
    "extends": ["react-app"]
  },
  "browserslist": {
    "production": [">0.2%", "not dead", "not op_mini all"],
    "development": ["last 1 chrome version", "last 1 firefox version", "last 1 safari version"]
  }
}
EOF

# 6. Frontend Dockerfile
cat > frontend/Dockerfile << 'EOF'
FROM node:18-alpine as builder
WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

FROM nginx:alpine
COPY --from=builder /app/build /usr/share/nginx/html
COPY nginx.conf /etc/nginx/conf.d/default.conf
EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
EOF

# 7. Frontend Nginx Config
cat > frontend/nginx.conf << 'EOF'
server {
    listen 80;
    server_name localhost;
    root /usr/share/nginx/html;
    index index.html;
    
    gzip on;
    gzip_types text/plain text/css application/json application/javascript;

    location / {
        try_files $uri $uri/ /index.html;
    }

    location /api {
        proxy_pass http://api:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
EOF

# 8. Frontend Public HTML
cat > frontend/public/index.html << 'EOF'
<!DOCTYPE html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ</title>
    <style>
      body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif; }
    </style>
  </head>
  <body>
    <div id="root"></div>
  </body>
</html>
EOF

# 9. Frontend App.js (ÙƒØ§Ù…Ù„)
cat > frontend/src/App.js << 'EOF'
import React, { useState, useEffect, useRef } from 'react';
import axios from 'axios';
import ReactMarkdown from 'react-markdown';

const api = axios.create({
  baseURL: '/api',
  headers: { 'Content-Type': 'application/json' }
});

api.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) config.headers.Authorization = `Bearer ${token}`;
  return config;
});

api.interceptors.response.use(
  (response) => response,
  (error) => {
    if (error.response?.status === 401) {
      localStorage.clear();
      window.location.reload();
    }
    return Promise.reject(error);
  }
);

const Login = ({ onLogin }) => {
  const [creds, setCreds] = useState({ username: '', password: '' });
  const [loading, setLoading] = useState(false);
  const [error, setError] = useState('');

  const handleSubmit = async (e) => {
    e.preventDefault();
    setLoading(true);
    try {
      const res = await api.post('/auth/login', creds);
      localStorage.setItem('token', res.data.token);
      localStorage.setItem('user', JSON.stringify(res.data.user));
      onLogin(res.data.user);
    } catch (err) {
      setError(err.response?.data?.error || 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„');
    } finally {
      setLoading(false);
    }
  };

  return (
    <div style={{ minHeight: '100vh', display: 'flex', alignItems: 'center', justifyContent: 'center', background: '#f3f4f6' }}>
      <div style={{ background: 'white', padding: '2rem', borderRadius: '8px', boxShadow: '0 4px 6px rgba(0,0,0,0.1)', width: '100%', maxWidth: '400px' }}>
        <h1 style={{ textAlign: 'center', color: '#1e40af', marginBottom: '1.5rem' }}>Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒÙŠ Ø§Ù„Ø¯Ø§Ø®Ù„ÙŠ</h1>
        {error && <div style={{ background: '#fee2e2', color: '#991b1b', padding: '0.75rem', borderRadius: '4px', marginBottom: '1rem', fontSize: '0.875rem' }}>{error}</div>}
        <form onSubmit={handleSubmit}>
          <div style={{ marginBottom: '1rem' }}>
            <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: 500 }}>Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…</label>
            <input
              type="text"
              placeholder="domain\\username"
              value={creds.username}
              onChange={(e) => setCreds({...creds, username: e.target.value})}
              style={{ width: '100%', padding: '0.5rem', border: '1px solid #d1d5db', borderRadius: '4px' }}
              required
            />
          </div>
          <div style={{ marginBottom: '1.5rem' }}>
            <label style={{ display: 'block', marginBottom: '0.5rem', fontSize: '0.875rem', fontWeight: 500 }}>ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±</label>
            <input
              type="password"
              value={creds.password}
              onChange={(e) => setCreds({...creds, password: e.target.value})}
              style={{ width: '100%', padding: '0.5rem', border: '1px solid #d1d5db', borderRadius: '4px' }}
              required
            />
          </div>
          <button
            type="submit"
            disabled={loading}
            style={{ width: '100%', padding: '0.75rem', background: '#2563eb', color: 'white', border: 'none', borderRadius: '4px', cursor: loading ? 'not-allowed' : 'pointer', opacity: loading ? 0.7 : 1 }}
          >
            {loading ? 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø¯Ø®ÙˆÙ„...' : 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„'}
          </button>
        </form>
        <p style={{ marginTop: '1rem', fontSize: '0.75rem', color: '#6b7280', textAlign: 'center' }}>
          Ù…Ø«Ø§Ù„: company\\admin Ø£Ùˆ hr@company.local
        </p>
      </div>
    </div>
  );
};

const Chat = ({ user }) => {
  const [messages, setMessages] = useState([]);
  const [input, setInput] = useState('');
  const [loading, setLoading] = useState(false);
  const [context, setContext] = useState('general');
  const messagesEndRef = useRef(null);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
  }, [messages]);

  const sendMessage = async (e) => {
    e.preventDefault();
    if (!input.trim()) return;

    const userMsg = { role: 'user', content: input, time: new Date() };
    setMessages(prev => [...prev, userMsg]);
    setInput('');
    setLoading(true);

    try {
      const res = await api.post('/ai/chat', { message: input, context });
      setMessages(prev => [...prev, {
        role: 'assistant',
        content: res.data.response,
        model: res.data.model,
        time: new Date()
      }]);
    } catch (err) {
      setMessages(prev => [...prev, {
        role: 'error',
        content: err.response?.data?.error || 'Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø®Ø¯Ù…Ø© AI',
        time: new Date()
      }]);
    } finally {
      setLoading(false);
    }
  };

  return (
    <div style={{ height: '100vh', display: 'flex', flexDirection: 'column', background: '#f9fafb' }}>
      <div style={{ background: 'white', padding: '1rem', boxShadow: '0 1px 3px rgba(0,0,0,0.1)', display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>
        <div>
          <h2 style={{ margin: 0, fontSize: '1.25rem', color: '#111827' }}>Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯ Ø§Ù„Ø°ÙƒÙŠ</h2>
          <p style={{ margin: '0.25rem 0 0', fontSize: '0.875rem', color: '#6b7280' }}>
            {user.username} | {user.department} | {user.role}
          </p>
        </div>
        <div style={{ display: 'flex', gap: '0.5rem', alignItems: 'center' }}>
          <select 
            value={context} 
            onChange={(e) => setContext(e.target.value)}
            style={{ padding: '0.5rem', borderRadius: '4px', border: '1px solid #d1d5db' }}
          >
            <option value="general">Ø¹Ø§Ù…</option>
            {user.department === 'HR' && <option value="hr">Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©</option>}
            {user.department === 'Finance' && <option value="finance">Ù…Ø§Ù„ÙŠØ©</option>}
          </select>
          <button 
            onClick={() => { localStorage.clear(); window.location.reload(); }}
            style={{ padding: '0.5rem 1rem', background: '#dc2626', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' }}
          >
            Ø®Ø±ÙˆØ¬
          </button>
        </div>
      </div>

      <div style={{ flex: 1, overflowY: 'auto', padding: '1rem', maxWidth: '800px', margin: '0 auto', width: '100%' }}>
        {messages.length === 0 && (
          <div style={{ textAlign: 'center', color: '#9ca3af', marginTop: '4rem' }}>
            <p>Ù…Ø±Ø­Ø¨Ø§Ù‹ {user.username}ØŒ ÙƒÙŠÙ ÙŠÙ…ÙƒÙ†Ù†ÙŠ Ù…Ø³Ø§Ø¹Ø¯ØªÙƒØŸ</p>
          </div>
        )}
        
        {messages.map((msg, idx) => (
          <div key={idx} style={{ marginBottom: '1rem', display: 'flex', justifyContent: msg.role === 'user' ? 'flex-end' : 'flex-start' }}>
            <div style={{ 
              maxWidth: '70%', 
              padding: '1rem', 
              borderRadius: '8px',
              background: msg.role === 'user' ? '#2563eb' : msg.role === 'error' ? '#fee2e2' : 'white',
              color: msg.role === 'user' ? 'white' : msg.role === 'error' ? '#991b1b' : '#1f2937',
              boxShadow: msg.role === 'user' ? 'none' : '0 1px 3px rgba(0,0,0,0.1)'
            }}>
              <ReactMarkdown>{msg.content}</ReactMarkdown>
              <div style={{ fontSize: '0.75rem', marginTop: '0.5rem', opacity: 0.7 }}>
                {msg.time.toLocaleTimeString()}
                {msg.model && ` â€¢ ${msg.model}`}
              </div>
            </div>
          </div>
        ))}
        {loading && (
          <div style={{ display: 'flex', gap: '0.5rem', padding: '1rem' }}>
            <div style={{ width: '8px', height: '8px', background: '#9ca3af', borderRadius: '50%', animation: 'bounce 1s infinite' }}></div>
            <div style={{ width: '8px', height: '8px', background: '#9ca3af', borderRadius: '50%', animation: 'bounce 1s infinite 0.1s' }}></div>
            <div style={{ width: '8px', height: '8px', background: '#9ca3af', borderRadius: '50%', animation: 'bounce 1s infinite 0.2s' }}></div>
          </div>
        )}
        <div ref={messagesEndRef} />
      </div>

      <div style={{ background: 'white', padding: '1rem', borderTop: '1px solid #e5e7eb' }}>
        <form onSubmit={sendMessage} style={{ maxWidth: '800px', margin: '0 auto', display: 'flex', gap: '0.5rem' }}>
          <input
            type="text"
            value={input}
            onChange={(e) => setInput(e.target.value)}
            placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..."
            disabled={loading}
            style={{ flex: 1, padding: '0.75rem', border: '1px solid #d1d5db', borderRadius: '4px' }}
          />
          <button 
            type="submit" 
            disabled={loading}
            style={{ padding: '0.75rem 1.5rem', background: '#2563eb', color: 'white', border: 'none', borderRadius: '4px', cursor: 'pointer' }}
          >
            Ø¥Ø±Ø³Ø§Ù„
          </button>
        </form>
      </div>
      <style>{`
        @keyframes bounce {
          0%, 100% { transform: translateY(0); }
          50% { transform: translateY(-10px); }
        }
      `}</style>
    </div>
  );
};

function App() {
  const [user, setUser] = useState(null);

  useEffect(() => {
    const saved = localStorage.getItem('user');
    if (saved) setUser(JSON.parse(saved));
  }, []);

  return user ? <Chat user={user} /> : <Login onLogin={setUser} />;
}

export default App;
EOF

# 10. Frontend Index.js
cat > frontend/src/index.js << 'EOF'
import React from 'react';
import ReactDOM from 'react-dom/client';
import App from './App';

const root = ReactDOM.createRoot(document.getElementById('root'));
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
EOF

# 11. Prometheus Config
cat > prometheus/prometheus.yml << 'EOF'
global:
  scrape_interval: 15s
  evaluation_interval: 15s

scrape_configs:
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  - job_name: 'api'
    static_configs:
      - targets: ['api:3000']
    metrics_path: '/metrics'
EOF

# 12. Grafana Datasources
cat > grafana/provisioning/datasources/datasources.yml << 'EOF'
apiVersion: 1
datasources:
  - name: Prometheus
    type: prometheus
    access: proxy
    url: http://prometheus:9090
    isDefault: true
    editable: false
EOF

# 13. Ù…Ù„Ù Ø§Ù„Ø¨ÙŠØ¦Ø©
cat > .env << 'EOF'
# ØªØºÙŠÙŠØ± Ù‡Ø°Ù‡ Ø§Ù„Ù‚ÙŠÙ… Ù‚Ø¨Ù„ Ø§Ù„ØªØ´ØºÙŠÙ„ ÙÙŠ Ø§Ù„Ø¥Ù†ØªØ§Ø¬
JWT_SECRET=Change-This-To-Random-String-Min-32-Characters
DB_PASSWORD=Postgres-Secret-Password-123
GRAFANA_PASSWORD=admin123

# Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Active Directory (Ø§Ø®ØªÙŠØ§Ø±ÙŠ Ù„Ù„ØªØ¬Ø±Ø¨Ø©)
AD_URL=ldap://your-dc.company.local
AD_BASE_DN=dc=company,dc=local
AD_DOMAIN=company.local
AD_SERVICE_USER=svc-ai@company.local
AD_SERVICE_PASSWORD=Service-Account-Password
EOF

# 14. README
cat > README.md << 'EOF'
# Ù†Ø¸Ø§Ù… Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠ

## Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹

```bash
# 1. Ø¨Ù†Ø§Ø¡ ÙˆØªØ´ØºÙŠÙ„
docker-compose up -d --build

# 2. ØªØ­Ù…ÙŠÙ„ Ù†Ù…ÙˆØ°Ø¬ AI (Ø£ÙˆÙ„ Ù…Ø±Ø© ÙÙ‚Ø·)
docker-compose exec ollama ollama pull llama3:8b

# 3. Ø§Ù„ÙˆØµÙˆÙ„
# Ø§Ù„ØªØ·Ø¨ÙŠÙ‚: http://localhost
# Grafana: http://localhost:3000 (admin/admin123)
