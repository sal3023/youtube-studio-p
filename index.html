import { useState, useEffect } from 'react';
import Head from 'next/head';
import dynamic from 'next/dynamic';
import styles from '../styles/AppDashboard.module.css';

// ุชุญููู ุงูููููุงุช ุงูุฏููุงููููุฉ ูุชุญุณูู ุงูุฃุฏุงุก
const ContentGenerator = dynamic(() => import('../components/ContentGenerator'));
const AnalyticsDashboard = dynamic(() => import('../components/AnalyticsDashboard'));
const AutoPublisher = dynamic(() => import('../components/AutoPublisher'));

export default function AppDashboard() {
  const [activeTab, setActiveTab] = useState('generate');
  const [isArabic, setIsArabic] = useState(true);
  const [darkMode, setDarkMode] = useState(false);
  const [apiStatus, setApiStatus] = useState({
    openai: false,
    google: false,
    twitter: false
  });

  useEffect(() => {
    // ุงูุชุญูู ูู ุญุงูุฉ APIs ุนูุฏ ุงูุชุญููู
    checkApiStatus();
  }, []);

  const checkApiStatus = async () => {
    try {
      const res = await fetch('/api/check-status');
      const data = await res.json();
      setApiStatus(data);
    } catch (error) {
      console.error('Error checking API status:', error);
    }
  };

  return (
    <div className={`${styles.container} ${darkMode ? styles.dark : ''}`}>
      <Head>
        <title>ููุญุฉ ุชุญูู ุงููุดุฑ ุงูุขูู</title>
        <meta name="description" content="ูุธุงู ุงููุดุฑ ุงูุขูู ุงููุชูุงูู ุจุงูุฐูุงุก ุงูุงุตุทูุงุนู" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
      </Head>

      {/* ุดุฑูุท ุงูุชููู ุงูุนููู */}
      <header className={styles.header}>
        <div className={styles.logo}>
          <h1>ุงููุธุงู ุงูุฐูู ูููุดุฑ ุงูุขูู</h1>
        </div>
        
        <div className={styles.controls}>
          <button 
            onClick={() => setIsArabic(!isArabic)}
            className={styles.langButton}
          >
            {isArabic ? 'English' : 'ุงูุนุฑุจูุฉ'}
          </button>
          
          <button 
            onClick={() => setDarkMode(!darkMode)}
            className={styles.themeButton}
          >
            {darkMode ? 'โ๏ธ' : '๐'}
          </button>
        </div>
      </header>

      {/* ุงูุดุฑูุท ุงูุฌุงูุจู */}
      <nav className={styles.sidebar}>
        <div className={styles.apiStatus}>
          <h3>ุญุงูุฉ ุงูุงุชุตุงู:</h3>
          <ul>
            <li className={apiStatus.openai ? styles.online : styles.offline}>
              OpenAI: {apiStatus.openai ? 'ูุชุตู' : 'ุบูุฑ ูุชุตู'}
            </li>
            <li className={apiStatus.google ? styles.online : styles.offline}>
              Google: {apiStatus.google ? 'ูุชุตู' : 'ุบูุฑ ูุชุตู'}
            </li>
            <li className={apiStatus.twitter ? styles.online : styles.offline}>
              Twitter: {apiStatus.twitter ? 'ูุชุตู' : 'ุบูุฑ ูุชุตู'}
            </li>
          </ul>
        </div>

        <ul className={styles.menu}>
          <li 
            className={activeTab === 'generate' ? styles.active : ''}
            onClick={() => setActiveTab('generate')}
          >
            {isArabic ? 'ุฅูุดุงุก ูุญุชูู' : 'Content Generation'}
          </li>
          <li 
            className={activeTab === 'publish' ? styles.active : ''}
            onClick={() => setActiveTab('publish')}
          >
            {isArabic ? 'ุงููุดุฑ ุงูุขูู' : 'Auto Publishing'}
          </li>
          <li 
            className={activeTab === 'analytics' ? styles.active : ''}
            onClick={() => setActiveTab('analytics')}
          >
            {isArabic ? 'ุงูุชุญูููุงุช' : 'Analytics'}
          </li>
        </ul>
      </nav>

      {/* ุงููุญุชูู ุงูุฑุฆูุณู */}
      <main className={styles.mainContent}>
        {activeTab === 'generate' && <ContentGenerator isArabic={isArabic} />}
        {activeTab === 'publish' && <AutoPublisher isArabic={isArabic} />}
        {activeTab === 'analytics' && <AnalyticsDashboard isArabic={isArabic} />}
      </main>

      {/* ุชุฐููู ุงูุตูุญุฉ */}
      <footer className={styles.footer}>
        <p>ยฉ {new Date().getFullYear()} ูุธุงู ุงููุดุฑ ุงูุฐูู. ุฌููุน ุงูุญููู ูุญููุธุฉ.</p>
      </footer>
    </div>
  );
}
