<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:system-ui}
        body{background:#0f172a;color:#fff;min-height:100vh}
        .header{background:#1e293b;padding:1rem;display:flex;justify-content:space-between;align-items:center}
        .btn{background:#6366f1;color:#fff;border:none;padding:0.5rem 1rem;border-radius:8px;cursor:pointer}
        .container{max-width:1200px;margin:0 auto;padding:1rem}
        .folders{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:1rem;margin:1rem 0}
        .folder{background:#1e293b;padding:1rem;border-radius:12px;cursor:pointer;transition:0.3s}
        .folder:hover{transform:translateY(-5px);background:#334155}
        .folder-icon{font-size:2rem;margin-bottom:0.5rem}
        .photos{display:grid;grid-template-columns:repeat(auto-fill,minmax(150px,1fr));gap:1rem}
        .photo{aspect-ratio:1;background:#1e293b;border-radius:8px;overflow:hidden;cursor:pointer}
        .photo img{width:100%;height:100%;object-fit:cover}
        .upload-zone{border:2px dashed #6366f1;padding:2rem;text-align:center;border-radius:12px;margin:1rem 0;cursor:pointer}
        .modal{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.8);z-index:100;justify-content:center;align-items:center;padding:1rem}
        .modal.active{display:flex}
        .modal-content{background:#1e293b;padding:1.5rem;border-radius:12px;width:100%;max-width:400px}
        .input{width:100%;padding:0.5rem;margin:0.5rem 0;background:#0f172a;border:1px solid #334155;color:#fff;border-radius:6px}
        .lightbox{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.95);z-index:200;justify-content:center;align-items:center}
        .lightbox.active{display:flex}
        .lightbox img{max-width:90%;max-height:90vh;border-radius:8px}
        .close{position:absolute;top:1rem;right:1rem;background:none;border:none;color:#fff;font-size:2rem;cursor:pointer}
    </style>
</head>
<body>
    <div class="header">
        <h2>ğŸ“· Ù…Ø¹Ø±Ø¶ Ø§Ù„ØµÙˆØ±</h2>
        <div>
            <button class="btn" onclick="showFolderModal()">+ Ù…Ø¬Ù…ÙˆØ¹Ø©</button>
            <button class="btn" onclick="document.getElementById('file').click()">+ ØµÙˆØ±</button>
        </div>
    </div>
    
    <div class="container">
        <div class="upload-zone" onclick="document.getElementById('file').click()">
            <h3>ğŸ“ Ø§Ø³Ø­Ø¨ Ø§Ù„ØµÙˆØ± Ù‡Ù†Ø§ Ø£Ùˆ Ø§Ù†Ù‚Ø±</h3>
        </div>
        <input type="file" id="file" multiple accept="image/*" style="display:none" onchange="upload(this)">
        
        <div id="foldersView">
            <h3>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</h3>
            <div class="folders" id="folders"></div>
        </div>
        
        <div id="photosView" style="display:none">
            <button class="btn" onclick="back()">â† Ø±Ø¬ÙˆØ¹</button>
            <h3 id="folderTitle"></h3>
            <div class="photos" id="photos"></div>
        </div>
    </div>

    <div class="modal" id="folderModal">
        <div class="modal-content">
            <h3>Ù…Ø¬Ù…ÙˆØ¹Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
            <input type="text" class="input" id="folderName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹Ø©">
            <button class="btn" onclick="createFolder()" style="width:100%">Ø¥Ù†Ø´Ø§Ø¡</button>
            <button class="btn" onclick="hideModal()" style="width:100%;margin-top:0.5rem;background:#334155">Ø¥Ù„ØºØ§Ø¡</button>
        </div>
    </div>

    <div class="lightbox" id="lightbox" onclick="this.classList.remove('active')">
        <button class="close" onclick="hideLightbox()">Ã—</button>
        <img id="lightboxImg" src="">
    </div>

    <script>
        let folders=JSON.parse(localStorage.getItem('folders')||'[]');
        let photos=JSON.parse(localStorage.getItem('photos')||'[]');
        let currentFolder=null;

        function save(){localStorage.setItem('folders',JSON.stringify(folders));localStorage.setItem('photos',JSON.stringify(photos))}
        
        function renderFolders(){
            const el=document.getElementById('folders');
            if(folders.length===0){el.innerHTML='<p style="grid-column:1/-1;color:#64748b">Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¬Ù…ÙˆØ¹Ø§Øª</p>';return}
            el.innerHTML=folders.map(f=>{
                const count=photos.filter(p=>p.folder===f.id).length;
                return`<div class="folder" onclick="openFolder('${f.id}')"><div class="folder-icon">ğŸ“</div><div><b>${f.name}</b><br><small>${count} ØµÙˆØ±Ø©</small></div></div>`
            }).join('')
        }

        function showFolderModal(){document.getElementById('folderModal').classList.add('active')}
        function hideModal(){document.getElementById('folderModal').classList.remove('active')}
        
        function createFolder(){
            const name=document.getElementById('folderName').value.trim();
            if(!name)return alert('Ø£Ø¯Ø®Ù„ Ø§Ù„Ø§Ø³Ù…');
            folders.push({id:Date.now().toString(),name});
            save();renderFolders();hideModal();
            document.getElementById('folderName').value='';
        }

        function openFolder(id){
            currentFolder=id;
            document.getElementById('foldersView').style.display='none';
            document.getElementById('photosView').style.display='block';
            document.getElementById('folderTitle').innerText=folders.find(f=>f.id===id)?.name||'';
            renderPhotos();
        }

        function back(){currentFolder=null;document.getElementById('foldersView').style.display='block';document.getElementById('photosView').style.display='none'}

        function renderPhotos(){
            const folderPhotos=photos.filter(p=>p.folder===currentFolder);
            const el=document.getElementById('photos');
            if(folderPhotos.length===0){el.innerHTML='<p style="color:#64748b">Ù„Ø§ ØªÙˆØ¬Ø¯ ØµÙˆØ±</p>';return}
            el.innerHTML=folderPhotos.map((p,i)=>`<div class="photo" onclick="showLightbox(${i})"><img src="${p.src}"></div>`).join('');
        }

        function upload(input){
            if(!currentFolder){if(!confirm('Ù„Ù… ØªØ®ØªØ± Ù…Ø¬Ù…ÙˆØ¹Ø©. Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©ØŸ'))return;createDefaultFolder()}
            Array.from(input.files).forEach(file=>{
                if(!file.type.startsWith('image/'))return;
                const reader=new FileReader();
                reader.onload=e=>{photos.push({id:Date.now(),folder:currentFolder,src:e.target.result});save();renderPhotos()};
                reader.readAsDataURL(file);
            });
        }

        function createDefaultFolder(){const id=Date.now().toString();folders.push({id,name:'Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§ÙØªØ±Ø§Ø¶ÙŠØ©'});currentFolder=id;save();renderFolders();openFolder(id)}

        function showLightbox(idx){
            const folderPhotos=photos.filter(p=>p.folder===currentFolder);
            document.getElementById('lightboxImg').src=folderPhotos[idx].src;
            document.getElementById('lightbox').classList.add('active');
        }

        function hideLightbox(){document.getElementById('lightbox').classList.remove('active')}

        renderFolders();
    </script>
</body>
</html>
